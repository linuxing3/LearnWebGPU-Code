add_rules('mode.debug', 'mode.release')

add_requires('glfw')
add_requires('tinyobjloader')
add_requires('stb')

target('glfw3webgpu')
set_kind('static')
add_files('vendor/glfw3webgpu/*.c')
add_includedirs('vendor/glfw3webgpu')
add_includedirs('vendor/webgpu/include/webgpu')
add_packages('glfw')
add_links('wgpu')

target('imgui')
set_kind('static')
add_files('vendor/imgui/*.cpp')
add_files('vendor/imgui/backends/imgui_impl_glfw.cpp')
add_files('vendor/imgui/backends/imgui_impl_wgpu.cpp')
add_files('vendor/imgui/backends/imgui_impl_vulkan.cpp')
add_includedirs('vendor/imgui')
add_includedirs('vendor/webgpu/include')
add_includedirs('vendor/webgpu/include/webgpu')
add_packages('glfw')
add_links('wgpu')

-- target
target('wgpu-imgui-app')
set_kind('binary')
set_targetdir('build')
add_defines('RESOURCE_DIR="../resources"')
add_defines('WGPU_TARGET=WGPU_TARGET_LINUX_X11')
add_defines('GLFW_EXPOSE_NATIVE_X11')
add_files('src/*.cpp')
add_files('src/Walnut/**.cpp')
add_includedirs('vendor/webgpu/include/webgpu')
add_includedirs('vendor/imgui')
add_includedirs('vendor/glfw3webgpu')
add_includedirs('src')
add_deps('glfw3webgpu')
add_deps('imgui')
add_packages('glfw', 'tinyobjloader', 'stb')
add_links('tbb', 'pthread', 'wgpu')
add_links('X11', 'Xrandr', 'Xrender', 'Xinerama', 'Xfixes', 'Xcursor', 'Xi', 'Xext')
